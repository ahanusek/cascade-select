{"version":3,"sources":["webpack:///./examples/simple.js","webpack:///./index.js","webpack:///./src/index.js","webpack:///./src/CascadeSelect.jsx","webpack:///external \"React\""],"names":[],"mappings":"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","file":"simple.js","sourcesContent":["'use strict';\n\n// use jsx to render html, do not modify simple.html\nvar CascadeSelect = require('rc-cascade-select');\nvar React = require('react');\n\nfunction simulateData(value) {\n  var data = [];\n  for (var i = 0; i < 4; i++) {\n    data.push({\n      name: value + '_' + i + ' : data',\n      value: value + '_' + i\n    })\n  }\n  return data;\n}\n\nclass Component extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      value: []\n    };\n  }\n\n  onChange(value) {\n    console.log('value changed', value);\n    this.setState({\n      value: value\n    });\n  }\n\n  load(id, callback) {\n    console.log('load data for: ' + id);\n    callback(null, simulateData(id || '1'));\n  }\n\n  render() {\n    return <CascadeSelect\n      value={this.state.value}\n      allText=\"i want all\"\n      onChange={this.onChange.bind(this)}\n      loader={this.load}>\n      <span>\n        <select></select>\n      </span>\n      <select></select>\n      <select></select>\n    </CascadeSelect>;\n  }\n}\n\nReact.render(<div>\n  <h1>simple cascade select</h1>\n  <div><Component /></div>\n</div>, document.getElementById('__react-content'));\n\n\n\n/** WEBPACK FOOTER **\n ** ./examples/simple.js\n **/","'use strict';\n\nmodule.exports = require('./src/');\n\n\n\n/** WEBPACK FOOTER **\n ** ./index.js\n **/","'use strict';\n\nmodule.exports = require('./CascadeSelect');\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","'use strict';\n\n/**\n * yiminghe@gmail.com\n * cascade select\n */\nvar React = require('react');\n\nfunction series(datas, fn, end) {\n  var next = (error)=> {\n    if (error) {\n      end(error);\n    } else {\n      start++;\n      if (start === datas.length) {\n        end();\n        return;\n      }\n      fn(datas[start], next);\n    }\n  };\n  var start = -1;\n  next();\n}\n\nfunction findFromChildrenOfParent(parentData, id) {\n  var children = parentData && parentData.children || [];\n  var i;\n  for (i = 0; i < children.length; i++) {\n    if (String(children[i].value) === id) {\n      return children[i];\n    }\n  }\n}\n\nfunction addOptions(self, children) {\n  var i = 0;\n  var value = self.props.value;\n  var parentData = self.state.data;\n  var doIt = (doChildren) => {\n    // depth first\n    return React.Children.map(doChildren, (c) => {\n      if (c.type === 'select') {\n        var newProps = {};\n        var v = value[i] || '';\n        var data = parentData && parentData.children || [];\n        if (v) {\n          parentData = findFromChildrenOfParent(parentData, v);\n        } else {\n          parentData = null;\n        }\n        newProps.onChange = self.select.bind(self, i);\n        newProps.value = v;\n        var options = [<option value=\"\">{self.props.allText}</option>].concat(data.map((d) => {\n          return <option value={d.value}>{d.name}</option>;\n        }));\n        c = React.cloneElement(c, newProps, options);\n        i++;\n      } else if (c.props && c.props.children) {\n        c = React.cloneElement(c, null, doIt(c.props.children));\n      }\n      return c;\n    });\n  };\n\n  var ret = doIt(children);\n  self.selectCount = i;\n  return ret;\n}\n\nfunction complementTreeByValue(self, data, value) {\n  var time = self.time;\n  if (value && value.length) {\n    var parentData = data;\n    var i = 0;\n    series(value, (id, callback) => {\n      i++;\n      var node = findFromChildrenOfParent(parentData, id);\n      parentData = node;\n      if (!node) {\n        callback('end');\n        return;\n      }\n      if (node.children) {\n        callback();\n        return;\n      }\n      if (i === self.selectCount) {\n        callback();\n        return;\n      }\n      self.props.loader(id, (error, ret) => {\n        if (error) {\n          callback(error);\n          return;\n        }\n        node.children = ret;\n        callback();\n      });\n    }, ()=> {\n      if (self.time === time) {\n        self.setState({\n          data: data\n        });\n      }\n    });\n  } else {\n    self.setState({\n      data: data\n    });\n  }\n}\n\nclass CascadeSelect extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      data: {\n        children: []\n      }\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.time = Date.now();\n    complementTreeByValue(this, {children: this.state.data.children}, nextProps.value);\n  }\n\n  componentDidMount() {\n    var props = this.props;\n    props.loader(null, (error, data)=> {\n      if (error) {\n        return;\n      }\n      this.time = Date.now();\n      complementTreeByValue(this, {children: data}, this.props.value);\n    });\n  }\n\n  select(index, e) {\n    var value = this.props.value.concat([]);\n    for (var i = index + 1; i < value.length; i++) {\n      value[i] = '';\n    }\n    value[index] = e.target.value;\n    this.props.onChange(value);\n  }\n\n  render() {\n    var props = this.props;\n    var children = addOptions(this, props.children);\n    return <span className={props.className}>{children}</span>;\n  }\n}\n\nCascadeSelect.defaultProps = {\n  value: [],\n  allText: 'all',\n  onChange() {\n  },\n  loader() {\n  }\n};\n\nmodule.exports = CascadeSelect;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/CascadeSelect.jsx\n **/","module.exports = React;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"React\"\n ** module id = 5\n ** module chunks = 0\n **/"],"sourceRoot":""}