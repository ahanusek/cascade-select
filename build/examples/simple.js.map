{"version":3,"sources":["webpack:///./examples/simple.js","webpack:///external \"React\"","webpack:///./index.js","webpack:///./lib/CascadeSelect.js"],"names":[],"mappings":"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","sourcesContent":["/** @jsx React.DOM */\n// use jsx to render html, do not modify simple.html\nvar CascadeSelect = require('rc-cascade-select');\nvar React = require('react');\n\nfunction simulateData(value) {\n  var data = [];\n  for (var i = 0; i < 4; i++) {\n    data.push({\n      name: value + '_' + i + ' : data',\n      value: value + '_' + i\n    })\n  }\n  return data;\n}\n\nclass Component extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      value: []\n    };\n  }\n\n  onChange(value) {\n    console.log('value changed', value);\n    this.setState({\n      value: value\n    });\n  }\n\n  load(id, callback) {\n    console.log('load data for: ' + id);\n    callback(null, simulateData(id || '1'));\n  }\n\n  render() {\n    return <CascadeSelect\n      value={this.state.value}\n      allText=\"i want all\"\n      onChange={this.onChange.bind(this)}\n      load={this.load}>\n      <span><select></select></span>\n      <select></select>\n      <select></select>\n    </CascadeSelect>;\n  }\n}\n\nReact.render(<div>\n  <h1>simple cascade select</h1>\n  <Component />\n</div>, document.getElementById('__react-content'));\n\n\n\n/** WEBPACK FOOTER **\n ** ./examples/simple.js\n **/","module.exports = React;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"React\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require('./lib/CascadeSelect');\n\n\n\n/** WEBPACK FOOTER **\n ** ./index.js\n **/","/** @jsx React.DOM */\n\n'use strict';\n\n/**\n * yiminghe@gmail.com\n * cascade select\n */\nvar React = require('react');\n\nfunction series(datas, fn, end) {\n  var next = (error)=> {\n    if (error) {\n      end(error);\n    } else {\n      start++;\n      if (start === datas.length) {\n        end();\n        return;\n      }\n      fn(datas[start], next);\n    }\n  };\n  var start = -1;\n  next();\n}\n\nfunction findFromChildrenOfParent(parentData, id) {\n  var children = parentData && parentData.children || [];\n  var i;\n  for (i = 0; i < children.length; i++) {\n    if (String(children[i].value) === id) {\n      return children[i];\n    }\n  }\n}\n\nfunction addOptions(self, children) {\n  var i = 0;\n  var value = self.props.value;\n  var parentData = self.state.data;\n  var doIt = (children) => {\n    // depth first\n    return React.Children.map(children, (c) => {\n      if (c.type === 'select') {\n        var newProps = {};\n        var v = value[i] || '';\n        var data = parentData && parentData.children || [];\n        if (v) {\n          parentData = findFromChildrenOfParent(parentData, v);\n        } else {\n          parentData = null;\n        }\n        newProps.onChange = self.select.bind(self, i);\n        newProps.value = v;\n        var options = [<option value=\"\">{self.props.allText}</option>].concat(data.map((d) => {\n          return <option value={d.value}>{d.name}</option>;\n        }));\n        c = React.cloneElement(c, newProps, options);\n        i++;\n      } else if (c.props && c.props.children) {\n        c = React.cloneElement(c, null, doIt(c.props.children));\n      }\n      return c;\n    });\n  };\n\n  var ret = doIt(children);\n  self.selectCount = i;\n  return ret;\n}\n\nfunction complementTreeByValue(self, data, value) {\n  var time = self.time;\n  if (value && value.length) {\n    var parentData = data;\n    var i = 0;\n    series(value, (id, callback) => {\n      i++;\n      var node = findFromChildrenOfParent(parentData, id);\n      parentData = node;\n      if (!node) {\n        callback('end');\n        return;\n      }\n      if (node.children) {\n        callback();\n        return;\n      }\n      if (i === self.selectCount) {\n        callback();\n        return;\n      }\n      self.props.load(id, (error, data) => {\n        if (error) {\n          callback(error);\n          return;\n        }\n        node.children = data;\n        callback();\n      });\n    }, ()=> {\n      if (self.time === time) {\n        self.setState({\n          data: data\n        });\n      }\n    });\n  } else {\n    self.setState({\n      data: data\n    });\n  }\n}\n\nclass CascadeSelect extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      data: {\n        children: []\n      }\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.time = Date.now();\n    complementTreeByValue(this, {children: this.state.data.children}, nextProps.value);\n  }\n\n  componentDidMount() {\n    var props = this.props;\n    props.load(null, (error, data)=> {\n      if (error) {\n        return;\n      }\n      this.time = Date.now();\n      complementTreeByValue(this, {children: data}, this.props.value);\n    });\n  }\n\n  select(index, e) {\n    var value = this.props.value.concat([]);\n    for (var i = index + 1; i < value.length; i++) {\n      value[i] = '';\n    }\n    value[index] = e.target.value;\n    this.props.onChange(value);\n  }\n\n  render() {\n    var props = this.props;\n    var children = addOptions(this, props.children);\n    return <div className={props.className}>{children}</div>;\n  }\n}\n\nCascadeSelect.defaultProps = {\n  value: [],\n  allText: 'all',\n  onChange() {\n  },\n  load() {\n  }\n};\n\nmodule.exports = CascadeSelect;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/CascadeSelect.js\n **/"],"sourceRoot":"","file":"simple.js"}